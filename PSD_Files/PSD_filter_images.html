
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Plotting PSDs &#8212; Premerger observation and characterization of super-massive black hole binaries</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'PSD_Files/PSD_filter_images';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Observable Distance Plot" href="../Sensitive_Distance_Plot/README.html" />
    <link rel="prev" title="Generating the PSD files used in our analyses" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Premerger observation and characterization of super-massive black hole binaries</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Premerger Observation and Characterization of Super-Massive Black Hole Binaries
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Generating the PSD files used in our analyses</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Plotting PSDs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Sensitive_Distance_Plot/README.html">Observable Distance Plot</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Sensitive_Distance_Plot/plot_sensitive_distance.html">Sensitive time-distance figure</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Data/README.html">Data for Search and Parameter Estimation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Data/make_injections.html">Script to make the injections json file</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Search/README.html">Searching for pre-merger signals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Search/Optimal_SNR/README.html">Optimal SNR calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Search/Template_Banks/README.html">Generation of Template Banks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Search/Signal_Runs/README.html">Searching for injected signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Search/Significance_Runs/README.html">Assessing significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Search/plot_search_results.html">Plotting search results for mock signals</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Parameter_Estimation/README.html">Parameter Estimation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_Estimation/Config_Files/README.html">Automatically combining configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_Estimation/Running_Analyses/README.html">Running analyses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_Estimation/Making_Skymaps/README.html">Generating sky maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_Estimation/skymap_plots.html">Making skymap-related plots</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/icg-gravwaves/lisa_premerger_paper" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/PSD_Files/PSD_filter_images.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Plotting PSDs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-psd-files">Load PSD files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-peaks-of-the-original-psds-are-then-used-to-create-the-smoothed-files">The peaks of the original PSDs are then used to create the smoothed files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-can-then-create-figure-3b-the-plots-are-not-shown-in-the-paper-in-the-order-created-here">We can then create Figure 3b (the plots are not shown in the paper in the order created here)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-cut-psd">Creating the “cut” PSD</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-for-figure-1a">Plot for Figure 1A</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-for-figure-1b">Plot for Figure 1B</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-response-function">Plotting the response function.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-figure-1b">Making Figure 1b</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-psd-kernels">Creating the PSD kernels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-want-the-zero-phase-filter-psds">Now want the zero-phase filter PSDs</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="plotting-psds">
<h1>Plotting PSDs<a class="headerlink" href="#plotting-psds" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;../paper.mplstyle&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_peaks</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pycbc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pycbc.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_frequencyseries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pycbc</span><span class="w"> </span><span class="kn">import</span> <span class="n">psd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pycbc.psd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pycbc.waveform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pycbc.filter</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/pycbc/types/array.py:36: UserWarning: Wswiglal-redir-stdio:

SWIGLAL standard output/error redirection is enabled in IPython.
This may lead to performance penalties. To disable locally, use:

with lal.no_swig_redirect_standard_output_error():
    ...

To disable globally, use:

lal.swig_redirect_standard_output_error(False)

Note however that this will likely lead to error messages from
LAL functions being either misdirected or lost when called from
Jupyter notebooks.

To suppress this warning, use:

import warnings
warnings.filterwarnings(&quot;ignore&quot;, &quot;Wswiglal-redir-stdio&quot;)
import lal

  import lal as _lal
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No CuPy
No CuPy or GPU PhenomHM module.
No CuPy or GPU response available.
No CuPy or GPU interpolation available.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PSD files are stored GZIPPEd, so need to GunZIP</span>
<span class="c1"># the `yes n` part of this commands skips if the file has already</span>
<span class="c1"># been unzipped in this directory</span>
<span class="c1"># ! yes n | gunzip -k model_AE_TDI1_optimistic.txt.gz</span>
<span class="c1"># ! yes n | gunzip -k model_AE_TDI1_pessimistic.txt.gz</span>
<span class="c1"># ! yes n | gunzip -k model_T_TDI1_optimistic.txt.gz</span>
<span class="c1"># ! yes n | gunzip -k model_T_TDI1_pessimistic.txt.gz</span>
<span class="c1"># ! yes n | gunzip -k model_AE_TDI1_SMOOTH_CUT_optimistic.txt.gz</span>
<span class="c1"># ! yes n | gunzip -k model_AE_TDI1_SMOOTH_optimistic.txt.gz</span>
<span class="c1"># ! yes n | gunzip -k model_AE_TDI1_SMOOTH_pessimistic.txt.gz</span>
</pre></div>
</div>
</div>
</div>
<section id="load-psd-files">
<h2>Load PSD files<a class="headerlink" href="#load-psd-files" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">load_frequencyseries</span><span class="p">(</span><span class="s1">&#39;model_AE_TDI1_optimistic.txt&#39;</span><span class="p">)</span>
<span class="c1"># We don&#39;t actually need the very highest frequencies here</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">1000001</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">load_frequencyseries</span><span class="p">(</span><span class="s1">&#39;model_T_TDI1_optimistic.txt&#39;</span><span class="p">)</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">at</span><span class="p">[:</span><span class="mi">1000001</span><span class="p">]</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">load_frequencyseries</span><span class="p">(</span><span class="s1">&#39;model_AE_TDI1_pessimistic.txt&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:</span><span class="mi">1000001</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">bt</span> <span class="o">=</span> <span class="n">load_frequencyseries</span><span class="p">(</span><span class="s1">&#39;model_T_TDI1_pessimistic.txt&#39;</span><span class="p">)</span>
<span class="n">bt</span> <span class="o">=</span> <span class="n">bt</span><span class="p">[:</span><span class="mi">1000001</span><span class="p">]</span>
<span class="n">bt</span> <span class="o">=</span> <span class="n">bt</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

<span class="c1"># These &quot;SMOOTH&quot; PSDs were made manually based on stuff in the next cells.</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">from_txt</span><span class="p">(</span>
    <span class="s1">&#39;model_AE_TDI1_SMOOTH_optimistic.txt&#39;</span><span class="p">,</span>
    <span class="mi">1000001</span><span class="p">,</span>
    <span class="n">a</span><span class="o">.</span><span class="n">delta_f</span><span class="p">,</span>
    <span class="n">a</span><span class="o">.</span><span class="n">delta_f</span><span class="p">,</span>
    <span class="n">is_asd_file</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">from_txt</span><span class="p">(</span>
    <span class="s1">&#39;model_AE_TDI1_SMOOTH_pessimistic.txt&#39;</span><span class="p">,</span>
    <span class="mi">1000001</span><span class="p">,</span>
    <span class="n">b</span><span class="o">.</span><span class="n">delta_f</span><span class="p">,</span>
    <span class="n">b</span><span class="o">.</span><span class="n">delta_f</span><span class="p">,</span>
    <span class="n">is_asd_file</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">a1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">b1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

<span class="n">inva</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">invb</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">inva1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">a1</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">invb1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">b1</span><span class="o">**</span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/pycbc/types/array.py:390: RuntimeWarning: divide by zero encountered in divide
  return self._data.__rtruediv__(other)
/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/pycbc/types/array.py:390: RuntimeWarning: invalid value encountered in divide
  return self._data.__rtruediv__(other)
</pre></div>
</div>
</div>
</div>
<section id="the-peaks-of-the-original-psds-are-then-used-to-create-the-smoothed-files">
<h3>The peaks of the original PSDs are then used to create the smoothed files<a class="headerlink" href="#the-peaks-of-the-original-psds-are-then-used-to-create-the-smoothed-files" title="Link to this heading">#</a></h3>
<p>Here’s how we generated the smoothed PSD files, the files are saved to disk, and then in above (so don’t need to be remade every time). Noting that the high-frequency sensitivity is the same in all 3
PSDs, so we only need to do the “smoothing” process once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_peaks</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">new_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a_peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">a_peaks</span><span class="p">])</span>
<span class="n">psd_values</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">new_indices</span><span class="p">]</span> <span class="c1"># Similar for the other PSDs</span>
<span class="n">psd_indices</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">new_indices</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">psd_indices</span><span class="p">,</span> <span class="n">psd_values</span><span class="p">)</span>
<span class="c1"># Then these two are saved as a 2-column ASCII file to make the &quot;SMOOTH&quot; PSDs given above.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/pycbc/types/array.py:225: ComplexWarning: Casting complex values to real discards the imaginary part
  arr = arr.astype(dtype)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/matplotlib/cbook.py:1709: ComplexWarning: Casting complex values to real discards the imaginary part
  return math.isfinite(val)
/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/matplotlib/cbook.py:1345: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fb8b0429660&gt;]
</pre></div>
</div>
<img alt="../_images/199758c162544ff88f8416de6965b5a0e4e4b872d584eb896322cff188a7c031.png" src="../_images/199758c162544ff88f8416de6965b5a0e4e4b872d584eb896322cff188a7c031.png" />
</div>
</div>
</section>
<section id="we-can-then-create-figure-3b-the-plots-are-not-shown-in-the-paper-in-the-order-created-here">
<h3>We can then create Figure 3b (the plots are not shown in the paper in the order created here)<a class="headerlink" href="#we-can-then-create-figure-3b-the-plots-are-not-shown-in-the-paper-in-the-order-created-here" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original PSD&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Smoothed PSD&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density ($\mathrm</span><span class="si">{Hz}</span><span class="s1">^{-1}$)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1E-44</span><span class="p">,</span><span class="mf">1E-36</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">1E-2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1">#plt.savefig(&#39;Figure3b.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb8b245b760&gt;
</pre></div>
</div>
<img alt="../_images/9639dd8afd3dc9fc1599d49a19bd05553b9fae04d0042fb4a5a0e374212d7ffc.png" src="../_images/9639dd8afd3dc9fc1599d49a19bd05553b9fae04d0042fb4a5a0e374212d7ffc.png" />
</div>
</div>
</section>
</section>
<section id="creating-the-cut-psd">
<h2>Creating the “cut” PSD<a class="headerlink" href="#creating-the-cut-psd" title="Link to this heading">#</a></h2>
<p>Here we create the “cut” PSD, we use a sigmoid to bring the PSD from the “optimistic” one to a “large” value … In hindsight the “large” value may not have been large enough (or the sigmoid should be broader). This didn’t affect results, but can result in erroneous signal power below this point if one is not very careful. … This is more clearly seen when we create the zero-latency filter later on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1c</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
<span class="n">a1c</span> <span class="o">=</span> <span class="n">a1c</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="n">a1c_smoothed</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a1c</span><span class="p">)</span>
<span class="n">a1c_smoothed2</span> <span class="o">=</span> <span class="n">pycbc</span><span class="o">.</span><span class="n">psd</span><span class="o">.</span><span class="n">estimate</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">a1c_smoothed</span><span class="p">,</span> <span class="mf">1E-8</span><span class="p">)</span>

<span class="n">ac_smoothed2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">ac_smoothed2</span> <span class="o">=</span> <span class="n">ac_smoothed2</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="n">ac_smoothed2</span> <span class="o">=</span> <span class="n">pycbc</span><span class="o">.</span><span class="n">psd</span><span class="o">.</span><span class="n">estimate</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ac_smoothed2</span><span class="p">,</span> <span class="mf">1E-8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/gareth/miniconda3/envs/env_lisa_premerger/lib/python3.10/site-packages/pycbc/types/array.py:864: ComplexWarning: Casting complex values to real discards the imaginary part
  return self._data.astype(dtype)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_smoothing_points</span> <span class="o">=</span> <span class="mi">3001</span>
<span class="n">sigmoid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">num_smoothing_points</span><span class="p">))</span>
<span class="n">sigmoid</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigmoid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a1c_smoothed2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">num_smoothing_points</span><span class="p">:</span><span class="mi">10001</span><span class="p">])</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1E-36</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">*</span><span class="mi">0</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="o">*</span><span class="n">sigmoid</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">a1c_smoothed2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">num_smoothing_points</span><span class="p">:</span><span class="mi">10001</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
<span class="n">a1c_smoothed2</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">num_smoothing_points</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1E-36</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ac_smoothed2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">num_smoothing_points</span><span class="p">:</span><span class="mi">10001</span><span class="p">])</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1E-36</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">*</span><span class="mi">0</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="o">*</span><span class="n">sigmoid</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">ac_smoothed2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">num_smoothing_points</span><span class="p">:</span><span class="mi">10001</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
<span class="n">ac_smoothed2</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">num_smoothing_points</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1E-36</span>
<span class="c1"># We plot a1c_smoothed2 below to verify it is okay.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we just plot the sigmoid that was used to make sure we didn&#39;t mess up.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fea4be23a6c4bc7d1072de961e6367f6c4cd349d50b3cc9fc1277432f87a94ae.png" src="../_images/fea4be23a6c4bc7d1072de961e6367f6c4cd349d50b3cc9fc1277432f87a94ae.png" />
</div>
</div>
</section>
<section id="plot-for-figure-1a">
<h2>Plot for Figure 1A<a class="headerlink" href="#plot-for-figure-1a" title="Link to this heading">#</a></h2>
<p>We now have the 3 PSDs, so plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ac_smoothed2</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="mi">1000000</span><span class="p">],</span> <span class="n">ac_smoothed2</span><span class="p">[:</span><span class="mi">1000000</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density ($\mathrm</span><span class="si">{Hz}</span><span class="s1">^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">()</span>

<span class="c1"># Generate some fake lines to make a legend</span>
<span class="n">line1s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">line1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">line1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">leg1_aet</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">line1s</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A/E&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">line2s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">label2s</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Optimistic&#39;</span><span class="p">,</span> <span class="s1">&#39;Hard Cut&#39;</span><span class="p">,</span> <span class="s1">&#39;Pessimistic&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">iii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">line2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="n">iii</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">line2s</span><span class="p">,</span> <span class="n">label2s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">leg1_aet</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1E-44</span><span class="p">,</span><span class="mf">1E-36</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">1E-6</span><span class="p">,</span><span class="mf">2E-1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">([</span><span class="mf">1E-4</span><span class="p">,</span><span class="mf">1E-4</span><span class="p">],</span> <span class="p">[</span><span class="mf">1E-44</span><span class="p">,</span><span class="mf">1E-36</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>

<span class="c1">#plt.savefig(&#39;Figure1a.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5d7a1450cc5e661bb0d2b07a89a3117876995d42d41a6fe1b476bf6bbde74275.png" src="../_images/5d7a1450cc5e661bb0d2b07a89a3117876995d42d41a6fe1b476bf6bbde74275.png" />
</div>
</div>
</section>
<section id="plot-for-figure-1b">
<h2>Plot for Figure 1B<a class="headerlink" href="#plot-for-figure-1b" title="Link to this heading">#</a></h2>
<p>Now need to create the strain plot. Do this by empirically computing the response function from A,E,T to h(t) and applying that to the A,E,T PSDs.</p>
<p>We have commented out the following computation, and have instead provided the frequency response function as a file. This saves time when running this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constructing the average response from h(t) -&gt; A,E,T,</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_response_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mf">1E7</span><span class="p">:</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">131072</span><span class="o">*</span><span class="mi">32</span><span class="p">)</span>
        <span class="n">freq</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">64.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">131072</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">low_freq_cutoff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">delta_f</span><span class="p">)</span>
    <span class="n">nominal_distance</span> <span class="o">=</span> <span class="mi">2000</span>
        
    
    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)):</span>
        <span class="n">shared_waveform_LISA</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;spin1z&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;spin2z&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;delta_f&#39;</span><span class="p">:</span><span class="n">delta_f</span><span class="p">,</span>
            <span class="s1">&#39;distance&#39;</span><span class="p">:</span><span class="n">nominal_distance</span><span class="p">,</span>
            <span class="s1">&#39;f_lower&#39;</span><span class="p">:</span><span class="n">low_freq_cutoff</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">m1</span><span class="o">=</span><span class="n">m</span>
        <span class="n">m2</span><span class="o">=</span><span class="n">m</span>
        
        <span class="n">coa_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">inclination</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">polarization</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">eclipticlatitude</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">eclipticlongitude</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>


        <span class="n">wf</span> <span class="o">=</span> <span class="n">pycbc</span><span class="o">.</span><span class="n">waveform</span><span class="o">.</span><span class="n">get_fd_det_waveform</span><span class="p">(</span>
                <span class="o">**</span><span class="n">shared_waveform_LISA</span><span class="p">,</span>
                <span class="n">mass1</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span>
                <span class="n">mass2</span><span class="o">=</span><span class="n">m2</span><span class="p">,</span>
                <span class="n">f_final</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span>
                <span class="n">coa_phase</span><span class="o">=</span><span class="n">coa_phase</span><span class="p">,</span>
                <span class="n">inclination</span><span class="o">=</span><span class="n">inclination</span><span class="p">,</span>
                <span class="n">polarization</span><span class="o">=</span><span class="n">polarization</span><span class="p">,</span>
                <span class="n">eclipticlatitude</span><span class="o">=</span><span class="n">eclipticlatitude</span><span class="p">,</span>
                <span class="n">eclipticlongitude</span><span class="o">=</span><span class="n">eclipticlongitude</span><span class="p">,</span>
                <span class="n">ifos</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LISA_A&#39;</span><span class="p">,</span><span class="s1">&#39;LISA_E&#39;</span><span class="p">,</span><span class="s1">&#39;LISA_T&#39;</span><span class="p">],</span>
                <span class="n">approximant</span><span class="o">=</span><span class="s1">&#39;BBHX_PhenomD&#39;</span><span class="p">,</span>
                <span class="n">t_obs_start</span><span class="o">=</span><span class="mi">86400</span><span class="o">*</span><span class="mi">3000</span><span class="p">,</span>
                <span class="n">tc</span><span class="o">=</span><span class="mf">0.95</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">*</span> <span class="mi">3000</span><span class="p">,</span>
                <span class="n">tdi</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">t_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">wf2p</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pycbc</span><span class="o">.</span><span class="n">waveform</span><span class="o">.</span><span class="n">get_fd_waveform</span><span class="p">(</span>
                <span class="o">**</span><span class="n">shared_waveform_LISA</span><span class="p">,</span>
                <span class="n">mass1</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span>
                <span class="n">mass2</span><span class="o">=</span><span class="n">m2</span><span class="p">,</span>
                <span class="n">f_final</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span>
                <span class="n">coa_phase</span><span class="o">=</span><span class="n">coa_phase</span><span class="p">,</span>
                <span class="n">inclination</span><span class="o">=</span><span class="n">inclination</span><span class="p">,</span>
                <span class="n">approximant</span><span class="o">=</span><span class="s1">&#39;IMRPhenomD&#39;</span>
        <span class="p">)</span>
        <span class="n">wfa</span> <span class="o">=</span> <span class="n">wf</span><span class="p">[</span><span class="s1">&#39;LISA_A&#39;</span><span class="p">]</span>
        <span class="n">wfe</span> <span class="o">=</span> <span class="n">wf</span><span class="p">[</span><span class="s1">&#39;LISA_E&#39;</span><span class="p">]</span>
        <span class="n">wft</span> <span class="o">=</span> <span class="n">wf</span><span class="p">[</span><span class="s1">&#39;LISA_T&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ratioa</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wf2p</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">wfa</span><span class="o">.</span><span class="n">data</span><span class="p">[:])</span> <span class="p">)</span>
            <span class="n">ratioe</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wf2p</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">wfe</span><span class="o">.</span><span class="n">data</span><span class="p">[:])</span> <span class="p">)</span>
            <span class="n">ratiot</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wf2p</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">wft</span><span class="o">.</span><span class="n">data</span><span class="p">[:])</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ratioa</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ratioa</span><span class="p">[:]</span> <span class="o">*</span> <span class="n">count</span> <span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wf2p</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">wfa</span><span class="o">.</span><span class="n">data</span><span class="p">[:]))</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ratioe</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ratioe</span><span class="p">[:]</span> <span class="o">*</span> <span class="n">count</span> <span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wf2p</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">wfe</span><span class="o">.</span><span class="n">data</span><span class="p">[:]))</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ratiot</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ratiot</span><span class="p">[:]</span> <span class="o">*</span> <span class="n">count</span> <span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wf2p</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">wft</span><span class="o">.</span><span class="n">data</span><span class="p">[:]))</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">wfa</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span> <span class="n">ratioa</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ratioe</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ratiot</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
</div>
<p>Comment out the 3 cells below if you want to generate the response function again. (It doesn’t take <em>that</em> long to run). This was done at different points in frequency space to acheive different resolution across the frequency band … Probably it would have made more sense to generate Phenom using a non-uniform frequency spacing, but this is what we did.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># outs4 = get_response_function(1E4)</span>
<span class="c1"># outs6 = get_response_function(1E6)</span>
<span class="c1"># outs8 = get_response_function(1E8)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.loglog(outs4[0][1000:], outs4[1][1000:], label=&#39;A response correction&#39;)</span>
<span class="c1"># plt.loglog(outs4[0][1000:], outs4[2][1000:], label=&#39;E response correction&#39;)</span>
<span class="c1"># plt.loglog(outs4[0][1000:], outs4[3][1000:], label=&#39;T response correction&#39;)</span>

<span class="c1"># plt.loglog(outs6[0][55:900], outs6[1][55:900], label=&#39;A response correction&#39;)</span>
<span class="c1"># plt.loglog(outs6[0][55:900], outs6[2][55:900], label=&#39;E response correction&#39;)</span>
<span class="c1"># plt.loglog(outs6[0][55:900], outs6[3][55:900], label=&#39;T response correction&#39;)</span>

<span class="c1"># plt.loglog(outs8[0][:800], outs8[1][:800], label=&#39;A response correction&#39;)</span>
<span class="c1"># plt.loglog(outs8[0][:800], outs8[2][:800], label=&#39;E response correction&#39;)</span>
<span class="c1"># plt.loglog(outs8[0][:800], outs8[3][:800], label=&#39;T response correction&#39;)</span>

<span class="c1"># plt.legend(loc=&#39;lower right&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># aa = np.zeros([len(outs4[0])-1000+845+800,2])</span>
<span class="c1"># aa[:800,0] = outs8[0][:800]</span>
<span class="c1"># aa[:800,1] = outs8[1][:800]</span>
<span class="c1"># aa[800:800+845,0] = outs6[0][55:900]</span>
<span class="c1"># aa[800:800+845,1] = outs6[1][55:900]</span>
<span class="c1"># aa[800+845:,0] = outs4[0][1000:]</span>
<span class="c1"># aa[800+845:,1] = outs4[1][1000:]</span>

<span class="c1"># tt = np.zeros([len(outs4[0])-1000+845+800,2])</span>
<span class="c1"># tt[:800,0] = outs8[0][:800]</span>
<span class="c1"># tt[:800,1] = outs8[3][:800]</span>
<span class="c1"># tt[800:800+845,0] = outs6[0][55:900]</span>
<span class="c1"># tt[800:800+845,1] = outs6[3][55:900]</span>
<span class="c1"># tt[800+845:,0] = outs4[0][1000:]</span>
<span class="c1"># tt[800+845:,1] = outs4[3][1000:]</span>

<span class="c1"># plt.loglog(aa[:,0], aa[:,1])</span>
<span class="c1"># plt.loglog(tt[:,0], tt[:,1])</span>
<span class="c1"># plt.legend(loc=&#39;lower right&#39;)</span>

<span class="c1"># aainterp = interpolate.interp1d(aa[:,0], aa[:,1])</span>
<span class="c1"># ttinterp = interpolate.interp1d(tt[:,0], tt[:,1])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the response functions to an external file</span>
<span class="c1"># ainterp_array = aainterp(a.sample_frequencies[:-100])</span>
<span class="c1"># np.savetxt(&#39;AE_response_function.txt&#39;, ainterp_array)</span>
<span class="c1"># tinterp_array = ttinterp(at.sample_frequencies[:-100])</span>
<span class="c1"># np.savetxt(&#39;T_response_function.txt&#39;, tinterp_array)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the response functions from the external file</span>
<span class="n">ainterp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;AE_response_function.txt&#39;</span><span class="p">)</span>
<span class="n">tinterp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;T_response_function.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plotting-the-response-function">
<h3>Plotting the response function.<a class="headerlink" href="#plotting-the-response-function" title="Link to this heading">#</a></h3>
<p>This plot doesn’t appear in the paper, but does show the translation from A/E to what I would think of as a “normal” PSD (we than translate to characteristic strain to plot).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">ainterp_array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A/E&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">tinterp_array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Response function&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Response function&#39;)
</pre></div>
</div>
<img alt="../_images/bf2f4ae03f60a68ec6f789baf90ef85df82c83e114417af1564ec39f118c896d.png" src="../_images/bf2f4ae03f60a68ec6f789baf90ef85df82c83e114417af1564ec39f118c896d.png" />
</div>
</div>
</section>
<section id="making-figure-1b">
<h3>Making Figure 1b<a class="headerlink" href="#making-figure-1b" title="Link to this heading">#</a></h3>
<p>Now we generate Figure 1b</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">b_peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">35042</span><span class="p">),</span> <span class="n">a_peaks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
    <span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">],</span> 
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ainterp_array</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
    <span class="n">at</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">],</span> 
    <span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span> <span class="o">*</span> <span class="n">at</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">tinterp_array</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span>
<span class="p">)</span>

<span class="c1"># The smoothed PSD is at different sample frequencies than the model,</span>
<span class="c1"># so we interpolate the response function here</span>
<span class="n">aainterp</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
    <span class="n">at</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">],</span>
    <span class="n">ainterp_array</span>
<span class="p">)</span>
<span class="n">smoothed_interp_array</span> <span class="o">=</span> <span class="n">aainterp</span><span class="p">(</span><span class="n">a1c_smoothed2</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="mi">1000000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
    <span class="n">a1c_smoothed2</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="mi">1000000</span><span class="p">],</span>
    <span class="p">(</span><span class="n">a1c_smoothed2</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[:</span><span class="mi">1000000</span><span class="p">]</span> <span class="o">*</span> <span class="n">a1c_smoothed2</span><span class="p">[:</span><span class="mi">1000000</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">smoothed_interp_array</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
    <span class="n">b</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">],</span> 
    <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">ainterp_array</span><span class="p">[</span><span class="n">b_peaks</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1">#ax.loglog(a1c.sample_frequencies, a1c, label=&#39;Hard Cut&#39;)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Characteristic Strain&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">()</span>

<span class="c1"># Generate some fake things to make a legend</span>
<span class="n">line1s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">line1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">line1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">leg1_aet</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">line1s</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A/E&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">line2s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">label2s</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Optimistic&#39;</span><span class="p">,</span> <span class="s1">&#39;Hard Cut&#39;</span><span class="p">,</span> <span class="s1">&#39;Pessimistic&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">iii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">line2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="n">c</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="n">iii</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">line2s</span><span class="p">,</span> <span class="n">label2s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">leg1_aet</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1E-22</span><span class="p">,</span><span class="mf">1E-16</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">1E-6</span><span class="p">,</span><span class="mf">2E-1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">([</span><span class="mf">1E-4</span><span class="p">,</span><span class="mf">1E-4</span><span class="p">],</span> <span class="p">[</span><span class="mf">1E-44</span><span class="p">,</span><span class="mf">1E-26</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>

<span class="c1">#plt.savefig(&#39;Figure1b.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1248520/3359889947.py:9: RuntimeWarning: invalid value encountered in divide
  (a.sample_frequencies[b_peaks] * a.data[b_peaks]/(ainterp_array[b_peaks]**2))**0.5,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1248520/3359889947.py:16: RuntimeWarning: invalid value encountered in divide
  (at.sample_frequencies[b_peaks] * at.data[b_peaks]/(tinterp_array[b_peaks]**2))**0.5,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1248520/3359889947.py:37: RuntimeWarning: invalid value encountered in divide
  (b.sample_frequencies[b_peaks] * b[b_peaks]/(ainterp_array[b_peaks]**2))**0.5,
</pre></div>
</div>
<img alt="../_images/402a8e8e429701e80e15cacc1f359c4bd52a50b3158f763f5d8d24ba74830cfc.png" src="../_images/402a8e8e429701e80e15cacc1f359c4bd52a50b3158f763f5d8d24ba74830cfc.png" />
</div>
</div>
</section>
</section>
<section id="creating-the-psd-kernels">
<h2>Creating the PSD kernels<a class="headerlink" href="#creating-the-psd-kernels" title="Link to this heading">#</a></h2>
<p>Now we begin the process of computing the zero-latency PSDs and the various plots associated with that.</p>
<p>First we just IFFT the various PSDs (roll to make plotting easier).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_cutpsd</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">ac_smoothed2</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">inv_cutpsd</span> <span class="o">=</span> <span class="n">inv_cutpsd</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">inv_cutpsdc</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">a1c_smoothed2</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">inv_cutpsdc</span> <span class="o">=</span> <span class="n">inv_cutpsdc</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

<span class="n">inv_cutpsd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">inv_cutpsdc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">inva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">inva1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">invb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">invb1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 

<span class="n">at</span> <span class="o">=</span> <span class="n">inva</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="n">at</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">at</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">100000</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">at</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">a1t</span> <span class="o">=</span> <span class="n">inva1</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="n">a1t</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">a1t</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">100000</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">a1t</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">bt</span> <span class="o">=</span> <span class="n">invb</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="n">bt</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">bt</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">100000</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bt</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">b1t</span> <span class="o">=</span> <span class="n">invb1</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="n">b1t</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b1t</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">100000</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b1t</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">inv_cutpsdt</span> <span class="o">=</span> <span class="n">inv_cutpsd</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="n">inv_cutpsdt</span><span class="o">.</span><span class="n">_epoch</span><span class="o">=</span><span class="mi">0</span>
<span class="n">inv_cutpsdt</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">100000</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">inv_cutpsdt</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">inv_cutpsdct</span> <span class="o">=</span> <span class="n">inv_cutpsdc</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="n">inv_cutpsdct</span><span class="o">.</span><span class="n">_epoch</span><span class="o">=</span><span class="mi">0</span>
<span class="n">inv_cutpsdct</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">100000</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">inv_cutpsdct</span><span class="o">.</span><span class="n">_epoch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="o">/</span><span class="mf">2.</span>
</pre></div>
</div>
</div>
</div>
<p>Now we make Figure 3a - except first here’s the version we don’t show, because it’s a mess! (ie. we don’t apply an envelope, this is the “raw” version of Figure 3a … the colour scheme is different, but it helps to sort of distinguish the lines).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">sample_times</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pessimistic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">sample_times</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimistic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">inv_cutpsdt</span><span class="o">.</span><span class="n">sample_times</span><span class="p">,</span> <span class="n">inv_cutpsdt</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hard Cut&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5E19</span><span class="p">,</span><span class="mf">1E20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">86400</span><span class="p">,</span><span class="mi">86400</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Whitening filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/40fc021558580804a3b63fa7f6ccd633839c7706f79b75d15194ff93061b6d2a.png" src="../_images/40fc021558580804a3b63fa7f6ccd633839c7706f79b75d15194ff93061b6d2a.png" />
</div>
</div>
<p>This plot then is Figure 3A</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="n">idxes</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">at</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1E20</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">1000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">sample_times</span><span class="p">[</span><span class="n">idxes</span><span class="p">]</span><span class="o">/</span><span class="mf">86400.</span><span class="p">,</span> <span class="p">(</span><span class="n">at</span><span class="p">)[</span><span class="n">idxes</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimistic&#39;</span><span class="p">)</span>
<span class="n">idxes</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">inv_cutpsdt</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1E20</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">1000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">inv_cutpsdt</span><span class="o">.</span><span class="n">sample_times</span><span class="p">[</span><span class="n">idxes</span><span class="p">]</span><span class="o">/</span><span class="mf">86400.</span><span class="p">,</span> <span class="p">(</span><span class="n">inv_cutpsdt</span><span class="p">)[</span><span class="n">idxes</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hard Cut&#39;</span><span class="p">)</span>
<span class="n">idxes</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">bt</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1E20</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">1000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">sample_times</span><span class="p">[</span><span class="n">idxes</span><span class="p">]</span><span class="o">/</span><span class="mf">86400.</span><span class="p">,</span> <span class="p">(</span><span class="n">bt</span><span class="p">)[</span><span class="n">idxes</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pessimistic&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.1E20</span><span class="p">,</span><span class="mf">1.4E20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Whitening filter (envelope)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;Figure3a.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4af9400047edf1172ad6d274aa0e23e506c8d09e675f9b869123f1d373daba2e.png" src="../_images/4af9400047edf1172ad6d274aa0e23e506c8d09e675f9b869123f1d373daba2e.png" />
</div>
</div>
<p>And this one is Figure 3C</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">a1t</span><span class="o">.</span><span class="n">sample_times</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span>
    <span class="n">a1t</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Smoothed Optimistic&#39;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">inv_cutpsdct</span><span class="o">.</span><span class="n">sample_times</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span>
    <span class="n">inv_cutpsdct</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Smoothed Hard Cut&#39;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">b1t</span><span class="o">.</span><span class="n">sample_times</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span>
    <span class="n">b1t</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Smoothed Pessimistic&#39;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;asinh&#39;</span><span class="p">,</span> <span class="n">linear_width</span><span class="o">=</span><span class="mf">2E13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5E19</span><span class="p">,</span><span class="mf">1E20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Whitening filter&#39;</span><span class="p">)</span>
<span class="n">major_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1E18</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E17</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E16</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E15</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1E14</span><span class="p">,</span> <span class="mf">1E15</span><span class="p">,</span>
               <span class="mf">1E16</span><span class="p">,</span> <span class="mf">1E17</span><span class="p">,</span> <span class="mf">1E18</span><span class="p">,</span> <span class="mf">1E19</span><span class="p">,</span> <span class="mf">1E20</span><span class="p">]</span>
<span class="n">major_tick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$-10^</span><span class="si">{18}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{17}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{16}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{15}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{14}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{14}</span><span class="s2">$&quot;</span><span class="p">,</span>
               <span class="s2">&quot;$10^</span><span class="si">{15}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{16}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{17}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{18}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{19}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{20}</span><span class="s2">$&quot;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">major_ticks</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">major_tick_labels</span><span class="p">)</span>  <span class="c1"># Adjust labels as needed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="c1">#plt.yticks(minor_ticks, minor=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>

<span class="c1">#plt.savefig(&#39;Figure3c.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f5604476fe1b644f1304e1876c912cadb2f941edfa96161423c36a9ee08d7d3e.png" src="../_images/f5604476fe1b644f1304e1876c912cadb2f941edfa96161423c36a9ee08d7d3e.png" />
</div>
</div>
</section>
<section id="now-want-the-zero-phase-filter-psds">
<h2>Now want the zero-phase filter PSDs<a class="headerlink" href="#now-want-the-zero-phase-filter-psds" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc.psd.lisa_pre_merger</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_pre_merger_psds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dlen</span> <span class="o">=</span> <span class="mi">2592000</span> <span class="c1"># Length in seconds</span>
<span class="n">sample_rate</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">psd_files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;./model_AE_TDI1_SMOOTH_optimistic.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;Optimistic&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;./model_AE_TDI1_SMOOTH_CUT_optimistic.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;Hard Cut&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;./model_AE_TDI1_SMOOTH_pessimistic.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;Pessimistic&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psd_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
<span class="n">ind_map</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="k">for</span> <span class="n">psd_file</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">chh</span> <span class="ow">in</span> <span class="n">psd_files</span><span class="p">:</span>
    
    <span class="n">zero_phase_kern</span> <span class="o">=</span> \
        <span class="n">generate_pre_merger_psds</span><span class="p">(</span>
            <span class="n">psd_file</span><span class="p">,</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">dlen</span><span class="p">,</span>
            <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span>
            <span class="n">kernel_length</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">86400</span><span class="o">*</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span>
        <span class="p">(</span><span class="n">zero_phase_kern</span><span class="p">[</span><span class="s1">&#39;TD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample_times</span> <span class="o">-</span> <span class="n">zero_phase_kern</span><span class="p">[</span><span class="s1">&#39;TD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span>
        <span class="n">zero_phase_kern</span><span class="p">[</span><span class="s1">&#39;TD&#39;</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">cycle</span><span class="p">[</span><span class="n">ind_map</span><span class="p">[</span><span class="n">chh</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;asinh&#39;</span><span class="p">,</span> <span class="n">linear_width</span><span class="o">=</span><span class="mf">1E13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (days)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Whitening filter&#39;</span><span class="p">)</span>
    <span class="n">major_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1E18</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E17</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E16</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E15</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1E14</span><span class="p">,</span> <span class="mf">1E15</span><span class="p">,</span>
               <span class="mf">1E16</span><span class="p">,</span> <span class="mf">1E17</span><span class="p">,</span> <span class="mf">1E18</span><span class="p">,</span> <span class="mf">1E19</span><span class="p">,</span> <span class="mf">1E20</span><span class="p">]</span>
    <span class="n">major_tick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$-10^</span><span class="si">{18}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{17}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{16}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{15}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$-10^</span><span class="si">{14}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{14}</span><span class="s2">$&quot;</span><span class="p">,</span>
               <span class="s2">&quot;$10^</span><span class="si">{15}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{16}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{17}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{18}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{19}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$10^</span><span class="si">{20}</span><span class="s2">$&quot;</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">major_ticks</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">major_tick_labels</span><span class="p">)</span>  <span class="c1"># Adjust labels as needed</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#plt.savefig(f&#39;Figure4{chh}.pdf&#39;)</span>
    
    <span class="n">psd_vals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span>
        <span class="n">zero_phase_kern</span><span class="p">[</span><span class="s1">&#39;FD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample_frequencies</span><span class="p">,</span>
        <span class="mf">1.</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">zero_phase_kern</span><span class="p">[</span><span class="s1">&#39;FD&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (zero-latency)&#39;</span>
    <span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">psd_vals</span><span class="p">:</span>    
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1E-46</span><span class="p">,</span><span class="mf">1E-38</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">1E-6</span><span class="p">,</span><span class="mf">2E-1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density ($</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">([</span><span class="mf">1E-4</span><span class="p">,</span><span class="mf">1E-4</span><span class="p">],</span> <span class="p">[</span><span class="mf">1E-43</span><span class="p">,</span><span class="mf">1E-36</span><span class="p">],</span> <span class="s1">&#39;c:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;Figure5.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9ccfd333d003d1d3a32293da8b22e311d08d349f150213b429140977ca514707.png" src="../_images/9ccfd333d003d1d3a32293da8b22e311d08d349f150213b429140977ca514707.png" />
<img alt="../_images/188fec9e1f875841f2e892b8f05398be1aabd7c94454d477bb2cfed10fd48af7.png" src="../_images/188fec9e1f875841f2e892b8f05398be1aabd7c94454d477bb2cfed10fd48af7.png" />
<img alt="../_images/6783e225b437c24fcf77e5647e60e224bcf7776388d2579ce3b0437162fa7c76.png" src="../_images/6783e225b437c24fcf77e5647e60e224bcf7776388d2579ce3b0437162fa7c76.png" />
<img alt="../_images/f3a063c25452977d04c178dd9d5da0e6452e45e57a3a2d37fd33f5caa438bd07.png" src="../_images/f3a063c25452977d04c178dd9d5da0e6452e45e57a3a2d37fd33f5caa438bd07.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./PSD_Files"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Generating the PSD files used in our analyses</p>
      </div>
    </a>
    <a class="right-next"
       href="../Sensitive_Distance_Plot/README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Observable Distance Plot</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-psd-files">Load PSD files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-peaks-of-the-original-psds-are-then-used-to-create-the-smoothed-files">The peaks of the original PSDs are then used to create the smoothed files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-can-then-create-figure-3b-the-plots-are-not-shown-in-the-paper-in-the-order-created-here">We can then create Figure 3b (the plots are not shown in the paper in the order created here)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-cut-psd">Creating the “cut” PSD</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-for-figure-1a">Plot for Figure 1A</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-for-figure-1b">Plot for Figure 1B</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-response-function">Plotting the response function.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-figure-1b">Making Figure 1b</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-psd-kernels">Creating the PSD kernels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-want-the-zero-phase-filter-psds">Now want the zero-phase filter PSDs</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>